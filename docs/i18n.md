# Internacionalización Unificada (i18n)

## Estructura de archivos

- Ubicación: `src/locales/<lang>/`
- Namespaces:
  - `landing.json`
  - `metrics.json`
  - `common.json`
- Cada archivo contiene un objeto con el nombre del namespace y sus claves.

## Uso en React

- Cliente: `const t = useTranslations('namespace')` y `t('path.to.key', { vars })`
- Ejemplos:
  - Interpolación: `t('greeting', { name })`
  - Pluralización: `t('seconds', { count })`
- Proveedor: `NextIntlClientProvider` ya recibe mensajes con fallback vía configuración de request.

## Uso fuera de componentes

- Servidor: `const t = await getTranslations({ locale, namespace })`
- Cliente utilidades: inyectar `t` desde el componente que llama o usar helpers que acepten una función traductora.

## Fallback de traducciones

- El request configura un merge de mensajes con fallback al idioma `en`.
- Si una clave falta en el idioma actual, se retorna la versión en `en`.

## Añadir nuevos textos

1. Elegir el namespace adecuado.
2. Añadir la clave en `src/locales/_base.json` ejecutando `npm run i18n:extract` o incorporarla manualmente.
3. Añadir traducción en cada idioma bajo `src/locales/<lang>/<namespace>.json`.
4. Usar la clave en código con `useTranslations` o `getTranslations`.

## Actualizar traducciones existentes

1. Editar las claves en los archivos de cada idioma.
2. Ejecutar `npm run i18n:validate` para verificar faltantes.
3. Revisar `src/locales/_report.json` para detectar claves sin traducir.

## Gestionar nuevos idiomas

1. Crear carpeta `src/locales/<nuevo-lang>/`.
2. Copiar `landing.json`, `metrics.json`, `common.json` desde `en` y traducir.
3. Validar con `npm run i18n:validate`.

## Extracción y validación en build

- Extracción: `npm run i18n:extract` detecta claves usadas en `useTranslations`/`getTranslations` y genera `src/locales/_base.json`.
- Validación: el script de `build` ejecuta `i18n:validate` y genera `src/locales/_report.json` con claves faltantes por idioma.

## Compatibilidad

- Componentes React: `useTranslations('namespace')`.
- Strings fuera de componentes: `getTranslations` en servidor o pasar `t` como parámetro.
- Textos dinámicos/interpolados: soportados con ICU y valores en `t('key', { ... })`.
